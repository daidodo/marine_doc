<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Marine Library: atomic_sync.hh Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Marine Library
   &#160;<span id="projectnumber">1.0</span>
   </div>
   <div id="projectbrief">C++ library for Linux Networking Development</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_8f88634022b2fc9e8bb020a4d4f478ba.html">marine</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">atomic_sync.hh</div>  </div>
</div><!--header-->
<div class="contents">
<a href="atomic__sync_8hh.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> * Copyright (c) 2016 Zhao DAI &lt;daidodo@gmail.com&gt;</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> * This program is free software: you can redistribute it and/or modify</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> * it under the terms of the GNU General Public License as published by</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"> * the Free Software Foundation, either version 3 of the License, or any</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"> * later version.</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"> * This program is distributed in the hope that it will be useful,</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment"> * GNU General Public License for more details.</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment"> * You should have received a copy of the GNU General Public License</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment"> * along with this program.  If not, see accompanying file LICENSE.txt</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment"> * or &lt;http://www.gnu.org/licenses/&gt;.</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#ifndef DOZERG_ATOMIC_SYNC_H_20130117</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#define DOZERG_ATOMIC_SYNC_H_20130117</span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#include &lt;cassert&gt;</span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#include &lt;cstddef&gt;</span>  <span class="comment">//NULL</span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#include &quot;impl/environment.hh&quot;</span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;NS_SERVER_BEGIN</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</div><div class="line"><a name="l00041"></a><span class="lineno"><a class="line" href="classCAtomicSync.html">   41</a></span>&#160;<span class="keyword">class </span><a class="code" href="classCAtomicSync.html">CAtomicSync</a></div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;{</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    <span class="keyword">typedef</span> <a class="code" href="classCAtomicSync.html">CAtomicSync&lt;T&gt;</a>  <a class="code" href="classCAtomicSync.html">__Myt</a>;</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="keyword">public</span>:</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <span class="keyword">typedef</span> T   value_type;</div><div class="line"><a name="l00051"></a><span class="lineno"><a class="line" href="classCAtomicSync.html#a1b4a85bf23aef90ec19d33062ded3a79">   51</a></span>&#160;    <span class="keyword">explicit</span> <a class="code" href="classCAtomicSync.html#a1b4a85bf23aef90ec19d33062ded3a79">CAtomicSync</a>(value_type c = value_type()):v_(c){}</div><div class="line"><a name="l00056"></a><span class="lineno"><a class="line" href="classCAtomicSync.html#a42b8d0a4687e6f050283f9525e4574d2">   56</a></span>&#160;    <a class="code" href="classCAtomicSync.html#a42b8d0a4687e6f050283f9525e4574d2">CAtomicSync</a>(<span class="keyword">const</span> __Myt &amp; c):v_(c.<a class="code" href="classCAtomicSync.html#aeef658711f60d07c644c091f98bc5256">load</a>()){}</div><div class="line"><a name="l00061"></a><span class="lineno"><a class="line" href="classCAtomicSync.html#aeef658711f60d07c644c091f98bc5256">   61</a></span>&#160;    value_type <a class="code" href="classCAtomicSync.html#aeef658711f60d07c644c091f98bc5256">load</a>()<span class="keyword"> const volatile</span>{</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">const_cast&lt;</span>__Myt *<span class="keyword">&gt;</span>(<span class="keyword">this</span>)-&gt;<a class="code" href="classCAtomicSync.html#ab228a9a9c4519f73875ba88385096a67">add_fetch</a>(0);</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    }</div><div class="line"><a name="l00069"></a><span class="lineno"><a class="line" href="classCAtomicSync.html#a93742d7607482008a8e99fa21a050a50">   69</a></span>&#160;    <span class="keyword">static</span> value_type <a class="code" href="classCAtomicSync.html#a93742d7607482008a8e99fa21a050a50">load</a>(<span class="keyword">const</span> value_type * v){</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;        assert(v);</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classCAtomicSync.html#ab228a9a9c4519f73875ba88385096a67">add_fetch</a>(const_cast&lt;value_type *&gt;(v), 0);</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    }</div><div class="line"><a name="l00078"></a><span class="lineno"><a class="line" href="classCAtomicSync.html#ab7fae7088e23cb9e3f21939dc4ab97d2">   78</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classCAtomicSync.html#ab7fae7088e23cb9e3f21939dc4ab97d2">store</a>(value_type c)<span class="keyword"> volatile</span>{<a class="code" href="classCAtomicSync.html#a800f80de01458303ff3ef71b591196b0">swap</a>(c);}</div><div class="line"><a name="l00085"></a><span class="lineno"><a class="line" href="classCAtomicSync.html#a2d638d58ad439b3f6d923cf97a63af01">   85</a></span>&#160;    <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="classCAtomicSync.html#a2d638d58ad439b3f6d923cf97a63af01">store</a>(value_type * v, value_type c){</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;        assert(v);</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;        <a class="code" href="classCAtomicSync.html#a800f80de01458303ff3ef71b591196b0">swap</a>(v, c);</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    }</div><div class="line"><a name="l00095"></a><span class="lineno"><a class="line" href="classCAtomicSync.html#aef897c7ad9343a5f412673bc93a36522">   95</a></span>&#160;    value_type <a class="code" href="classCAtomicSync.html#aef897c7ad9343a5f412673bc93a36522">fetch_add</a>(value_type c)<span class="keyword"> volatile</span>{<span class="keywordflow">return</span> __sync_fetch_and_add(&amp;v_, c);}</div><div class="line"><a name="l00103"></a><span class="lineno"><a class="line" href="classCAtomicSync.html#a7e7059f8f85ca634a98dd9ea90848558">  103</a></span>&#160;    <span class="keyword">static</span> value_type <a class="code" href="classCAtomicSync.html#a7e7059f8f85ca634a98dd9ea90848558">fetch_add</a>(value_type * v, value_type c){</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        assert(v);</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        <span class="keywordflow">return</span> __sync_fetch_and_add(v, c);</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    }</div><div class="line"><a name="l00113"></a><span class="lineno"><a class="line" href="classCAtomicSync.html#ab228a9a9c4519f73875ba88385096a67">  113</a></span>&#160;    value_type <a class="code" href="classCAtomicSync.html#ab228a9a9c4519f73875ba88385096a67">add_fetch</a>(value_type c)<span class="keyword"> volatile</span>{<span class="keywordflow">return</span> __sync_add_and_fetch(&amp;v_, c);}</div><div class="line"><a name="l00121"></a><span class="lineno"><a class="line" href="classCAtomicSync.html#a0dcc417cc796c9ef1c08251086dcf14d">  121</a></span>&#160;    <span class="keyword">static</span> value_type <a class="code" href="classCAtomicSync.html#a0dcc417cc796c9ef1c08251086dcf14d">add_fetch</a>(value_type * v, value_type c){</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        assert(v);</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;        <span class="keywordflow">return</span> __sync_add_and_fetch (v, c);</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    }</div><div class="line"><a name="l00131"></a><span class="lineno"><a class="line" href="classCAtomicSync.html#a20116c1a0e05a4e0ee0b5e40160dcc62">  131</a></span>&#160;    value_type <a class="code" href="classCAtomicSync.html#a20116c1a0e05a4e0ee0b5e40160dcc62">fetch_sub</a>(value_type c)<span class="keyword"> volatile</span>{<span class="keywordflow">return</span> __sync_fetch_and_sub(&amp;v_, c);}</div><div class="line"><a name="l00139"></a><span class="lineno"><a class="line" href="classCAtomicSync.html#ad5d9a892fe66a56cfcf70992e5fcceb7">  139</a></span>&#160;    <span class="keyword">static</span> value_type <a class="code" href="classCAtomicSync.html#ad5d9a892fe66a56cfcf70992e5fcceb7">fetch_sub</a>(value_type * v, value_type c){</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;        assert(v);</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        <span class="keywordflow">return</span> __sync_fetch_and_sub(v, c);</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    }</div><div class="line"><a name="l00149"></a><span class="lineno"><a class="line" href="classCAtomicSync.html#a2dd86acbf51e437a3f1158c5bdc06865">  149</a></span>&#160;    value_type <a class="code" href="classCAtomicSync.html#a2dd86acbf51e437a3f1158c5bdc06865">sub_fetch</a>(value_type c)<span class="keyword"> volatile</span>{<span class="keywordflow">return</span> __sync_sub_and_fetch(&amp;v_, c);}</div><div class="line"><a name="l00157"></a><span class="lineno"><a class="line" href="classCAtomicSync.html#ae2c1736027f13002c5e83319e7c9afc7">  157</a></span>&#160;    <span class="keyword">static</span> value_type <a class="code" href="classCAtomicSync.html#ae2c1736027f13002c5e83319e7c9afc7">sub_fetch</a>(value_type * v, value_type c){</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;        assert(v);</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        <span class="keywordflow">return</span> __sync_sub_and_fetch (v, c);</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    }</div><div class="line"><a name="l00167"></a><span class="lineno"><a class="line" href="classCAtomicSync.html#a7f3941a9b14a001f9aeea324d1af0086">  167</a></span>&#160;    value_type <a class="code" href="classCAtomicSync.html#a7f3941a9b14a001f9aeea324d1af0086">fetch_or</a>(value_type c)<span class="keyword"> volatile</span>{<span class="keywordflow">return</span> __sync_fetch_and_or(&amp;v_, c);}</div><div class="line"><a name="l00175"></a><span class="lineno"><a class="line" href="classCAtomicSync.html#aca73519f947756aa7eb520b5eeb507de">  175</a></span>&#160;    <span class="keyword">static</span> value_type <a class="code" href="classCAtomicSync.html#aca73519f947756aa7eb520b5eeb507de">fetch_or</a>(value_type * v, value_type c){</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;        assert(v);</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;        <span class="keywordflow">return</span> __sync_fetch_and_or(v, c);</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    }</div><div class="line"><a name="l00185"></a><span class="lineno"><a class="line" href="classCAtomicSync.html#ae40428b0e27d8e4eb578d2965a57b9f4">  185</a></span>&#160;    value_type <a class="code" href="classCAtomicSync.html#ae40428b0e27d8e4eb578d2965a57b9f4">or_fetch</a>(value_type c)<span class="keyword"> volatile</span>{<span class="keywordflow">return</span> __sync_or_and_fetch(&amp;v_, c);}</div><div class="line"><a name="l00193"></a><span class="lineno"><a class="line" href="classCAtomicSync.html#a6f46972f42f878525e0fa86f6e05b41d">  193</a></span>&#160;    <span class="keyword">static</span> value_type <a class="code" href="classCAtomicSync.html#a6f46972f42f878525e0fa86f6e05b41d">or_fetch</a>(value_type * v, value_type c){</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;        assert(v);</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;        <span class="keywordflow">return</span> __sync_or_and_fetch (v, c);</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    }</div><div class="line"><a name="l00203"></a><span class="lineno"><a class="line" href="classCAtomicSync.html#a598ddf1d30aeb3dd29ebb0be8e0309e0">  203</a></span>&#160;    value_type <a class="code" href="classCAtomicSync.html#a598ddf1d30aeb3dd29ebb0be8e0309e0">fetch_and</a>(value_type c)<span class="keyword"> volatile</span>{<span class="keywordflow">return</span> __sync_fetch_and_and(&amp;v_, c);}</div><div class="line"><a name="l00211"></a><span class="lineno"><a class="line" href="classCAtomicSync.html#ae58428be882e47785d37a9870b2b5630">  211</a></span>&#160;    <span class="keyword">static</span> value_type <a class="code" href="classCAtomicSync.html#ae58428be882e47785d37a9870b2b5630">fetch_and</a>(value_type * v, value_type c){</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;        assert(v);</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;        <span class="keywordflow">return</span> __sync_fetch_and_and(v, c);</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    }</div><div class="line"><a name="l00221"></a><span class="lineno"><a class="line" href="classCAtomicSync.html#a2356c7947ce01f0f952439340ea14629">  221</a></span>&#160;    value_type <a class="code" href="classCAtomicSync.html#a2356c7947ce01f0f952439340ea14629">and_fetch</a>(value_type c)<span class="keyword"> volatile</span>{<span class="keywordflow">return</span> __sync_and_and_fetch(&amp;v_, c);}</div><div class="line"><a name="l00229"></a><span class="lineno"><a class="line" href="classCAtomicSync.html#adbd228493fae2b1be866b22f20ee51e7">  229</a></span>&#160;    <span class="keyword">static</span> value_type <a class="code" href="classCAtomicSync.html#adbd228493fae2b1be866b22f20ee51e7">and_fetch</a>(value_type * v, value_type c){</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;        assert(v);</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;        <span class="keywordflow">return</span> __sync_and_and_fetch (v, c);</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    }</div><div class="line"><a name="l00239"></a><span class="lineno"><a class="line" href="classCAtomicSync.html#a9fbccf0e1f4d357c7c4416c67e2c3d0c">  239</a></span>&#160;    value_type <a class="code" href="classCAtomicSync.html#a9fbccf0e1f4d357c7c4416c67e2c3d0c">fetch_xor</a>(value_type c)<span class="keyword"> volatile</span>{<span class="keywordflow">return</span> __sync_fetch_and_xor(&amp;v_, c);}</div><div class="line"><a name="l00247"></a><span class="lineno"><a class="line" href="classCAtomicSync.html#ab06b03636b7cd804601784cab75a397f">  247</a></span>&#160;    <span class="keyword">static</span> value_type <a class="code" href="classCAtomicSync.html#ab06b03636b7cd804601784cab75a397f">fetch_xor</a>(value_type * v, value_type c){</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;        assert(v);</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;        <span class="keywordflow">return</span> __sync_fetch_and_xor(v, c);</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    }</div><div class="line"><a name="l00257"></a><span class="lineno"><a class="line" href="classCAtomicSync.html#a9c39c19f2ee1372d4501923015d4d0bb">  257</a></span>&#160;    value_type <a class="code" href="classCAtomicSync.html#a9c39c19f2ee1372d4501923015d4d0bb">xor_fetch</a>(value_type c)<span class="keyword"> volatile</span>{<span class="keywordflow">return</span> __sync_xor_and_fetch(&amp;v_, c);}</div><div class="line"><a name="l00265"></a><span class="lineno"><a class="line" href="classCAtomicSync.html#a08761322b28867ce843905271286e055">  265</a></span>&#160;    <span class="keyword">static</span> value_type <a class="code" href="classCAtomicSync.html#a08761322b28867ce843905271286e055">xor_fetch</a>(value_type * v, value_type c){</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;        assert(v);</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;        <span class="keywordflow">return</span> __sync_xor_and_fetch (v, c);</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    }</div><div class="line"><a name="l00275"></a><span class="lineno"><a class="line" href="classCAtomicSync.html#a800f80de01458303ff3ef71b591196b0">  275</a></span>&#160;    value_type <a class="code" href="classCAtomicSync.html#a800f80de01458303ff3ef71b591196b0">swap</a>(value_type c)<span class="keyword"> volatile</span>{<span class="keywordflow">return</span> __sync_lock_test_and_set(&amp;v_, c);}</div><div class="line"><a name="l00283"></a><span class="lineno"><a class="line" href="classCAtomicSync.html#a88a711114e610b692016bbda942b14e4">  283</a></span>&#160;    <span class="keyword">static</span> value_type <a class="code" href="classCAtomicSync.html#a88a711114e610b692016bbda942b14e4">swap</a>(value_type * v, value_type c){</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;        assert(v);</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;        <span class="keywordflow">return</span> __sync_lock_test_and_set(v, c);</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    }</div><div class="line"><a name="l00304"></a><span class="lineno"><a class="line" href="classCAtomicSync.html#a46c37f6df90d020ba65ee368934eb620">  304</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="classCAtomicSync.html#a46c37f6df90d020ba65ee368934eb620">compare_swap</a>(value_type expval, value_type newval, value_type * oldval = NULL)<span class="keyword"> volatile</span>{</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;        <span class="keywordflow">if</span>(NULL == oldval)</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;            <span class="keywordflow">return</span> __sync_bool_compare_and_swap(&amp;v_, expval, newval);</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;        *oldval = __sync_val_compare_and_swap(&amp;v_, expval, newval);</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;        <span class="keywordflow">return</span> (*oldval == expval);</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    }</div><div class="line"><a name="l00328"></a><span class="lineno"><a class="line" href="classCAtomicSync.html#a4ade83b771f2f450b1eee8abf6c73943">  328</a></span>&#160;    <span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="classCAtomicSync.html#a4ade83b771f2f450b1eee8abf6c73943">compare_swap</a>(value_type * val, value_type expval, value_type newval, value_type * oldval){</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;        assert(val);</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;        <span class="keywordflow">if</span>(NULL == oldval)</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;            <span class="keywordflow">return</span> __sync_bool_compare_and_swap(val, expval, newval);</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;        *oldval = __sync_val_compare_and_swap(val, expval, newval);</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;        <span class="keywordflow">return</span> (*oldval == expval);</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    }</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    value_type operator =(<span class="keyword">const</span> __Myt &amp; c)<span class="keyword"> volatile</span>{<span class="keywordflow">return</span> (v_ = c.<a class="code" href="classCAtomicSync.html#aeef658711f60d07c644c091f98bc5256">load</a>());}</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    value_type operator =(value_type c)<span class="keyword"> volatile</span>{<span class="keywordflow">return</span> (v_ = c);}</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    <span class="keyword">operator</span> value_type()<span class="keyword"> const volatile</span>{<span class="keywordflow">return</span> <a class="code" href="classCAtomicSync.html#aeef658711f60d07c644c091f98bc5256">load</a>();}</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    value_type operator ++()<span class="keyword"> volatile</span>{<span class="keywordflow">return</span> <a class="code" href="classCAtomicSync.html#ab228a9a9c4519f73875ba88385096a67">add_fetch</a>(1);}</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    value_type operator --()<span class="keyword"> volatile</span>{<span class="keywordflow">return</span> <a class="code" href="classCAtomicSync.html#a2dd86acbf51e437a3f1158c5bdc06865">sub_fetch</a>(1);}</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    value_type operator ++(<span class="keywordtype">int</span>)<span class="keyword"> volatile</span>{<span class="keywordflow">return</span> <a class="code" href="classCAtomicSync.html#aef897c7ad9343a5f412673bc93a36522">fetch_add</a>(1);}</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    value_type operator --(<span class="keywordtype">int</span>)<span class="keyword"> volatile</span>{<span class="keywordflow">return</span> <a class="code" href="classCAtomicSync.html#a20116c1a0e05a4e0ee0b5e40160dcc62">fetch_sub</a>(1);}</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    value_type operator +=(value_type c)<span class="keyword"> volatile</span>{<span class="keywordflow">return</span> <a class="code" href="classCAtomicSync.html#ab228a9a9c4519f73875ba88385096a67">add_fetch</a>(c);}</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    value_type operator -=(value_type c)<span class="keyword"> volatile</span>{<span class="keywordflow">return</span> <a class="code" href="classCAtomicSync.html#a2dd86acbf51e437a3f1158c5bdc06865">sub_fetch</a>(c);}</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    value_type operator |=(value_type c)<span class="keyword"> volatile</span>{<span class="keywordflow">return</span> <a class="code" href="classCAtomicSync.html#ae40428b0e27d8e4eb578d2965a57b9f4">or_fetch</a>(c);}</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    value_type operator &amp;=(value_type c)<span class="keyword"> volatile</span>{<span class="keywordflow">return</span> <a class="code" href="classCAtomicSync.html#a2356c7947ce01f0f952439340ea14629">and_fetch</a>(c);}</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    value_type operator ^=(value_type c)<span class="keyword"> volatile</span>{<span class="keywordflow">return</span> <a class="code" href="classCAtomicSync.html#a9c39c19f2ee1372d4501923015d4d0bb">xor_fetch</a>(c);}</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;<span class="keyword">private</span>:</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    value_type v_;</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;};</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;NS_SERVER_END</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;</div><div class="ttc" id="classCAtomicSync_html_ae58428be882e47785d37a9870b2b5630"><div class="ttname"><a href="classCAtomicSync.html#ae58428be882e47785d37a9870b2b5630">CAtomicSync::fetch_and</a></div><div class="ttdeci">static value_type fetch_and(value_type *v, value_type c)</div><div class="ttdoc">Get value and then AND atomically. </div><div class="ttdef"><b>Definition:</b> atomic_sync.hh:211</div></div>
<div class="ttc" id="classCAtomicSync_html_ab06b03636b7cd804601784cab75a397f"><div class="ttname"><a href="classCAtomicSync.html#ab06b03636b7cd804601784cab75a397f">CAtomicSync::fetch_xor</a></div><div class="ttdeci">static value_type fetch_xor(value_type *v, value_type c)</div><div class="ttdoc">Get value and then XOR atomically. </div><div class="ttdef"><b>Definition:</b> atomic_sync.hh:247</div></div>
<div class="ttc" id="classCAtomicSync_html_a88a711114e610b692016bbda942b14e4"><div class="ttname"><a href="classCAtomicSync.html#a88a711114e610b692016bbda942b14e4">CAtomicSync::swap</a></div><div class="ttdeci">static value_type swap(value_type *v, value_type c)</div><div class="ttdoc">Get value and then set atomically. </div><div class="ttdef"><b>Definition:</b> atomic_sync.hh:283</div></div>
<div class="ttc" id="classCAtomicSync_html_a6f46972f42f878525e0fa86f6e05b41d"><div class="ttname"><a href="classCAtomicSync.html#a6f46972f42f878525e0fa86f6e05b41d">CAtomicSync::or_fetch</a></div><div class="ttdeci">static value_type or_fetch(value_type *v, value_type c)</div><div class="ttdoc">OR and then get value atomically. </div><div class="ttdef"><b>Definition:</b> atomic_sync.hh:193</div></div>
<div class="ttc" id="classCAtomicSync_html_a2356c7947ce01f0f952439340ea14629"><div class="ttname"><a href="classCAtomicSync.html#a2356c7947ce01f0f952439340ea14629">CAtomicSync::and_fetch</a></div><div class="ttdeci">value_type and_fetch(value_type c) volatile</div><div class="ttdoc">AND and then get value atomically. </div><div class="ttdef"><b>Definition:</b> atomic_sync.hh:221</div></div>
<div class="ttc" id="classCAtomicSync_html_a93742d7607482008a8e99fa21a050a50"><div class="ttname"><a href="classCAtomicSync.html#a93742d7607482008a8e99fa21a050a50">CAtomicSync::load</a></div><div class="ttdeci">static value_type load(const value_type *v)</div><div class="ttdoc">Get value atomically. </div><div class="ttdef"><b>Definition:</b> atomic_sync.hh:69</div></div>
<div class="ttc" id="classCAtomicSync_html_a0dcc417cc796c9ef1c08251086dcf14d"><div class="ttname"><a href="classCAtomicSync.html#a0dcc417cc796c9ef1c08251086dcf14d">CAtomicSync::add_fetch</a></div><div class="ttdeci">static value_type add_fetch(value_type *v, value_type c)</div><div class="ttdoc">ADD and then get value atomically. </div><div class="ttdef"><b>Definition:</b> atomic_sync.hh:121</div></div>
<div class="ttc" id="classCAtomicSync_html_a4ade83b771f2f450b1eee8abf6c73943"><div class="ttname"><a href="classCAtomicSync.html#a4ade83b771f2f450b1eee8abf6c73943">CAtomicSync::compare_swap</a></div><div class="ttdeci">static bool compare_swap(value_type *val, value_type expval, value_type newval, value_type *oldval)</div><div class="ttdoc">Compare and set atomically. </div><div class="ttdef"><b>Definition:</b> atomic_sync.hh:328</div></div>
<div class="ttc" id="classCAtomicSync_html_a800f80de01458303ff3ef71b591196b0"><div class="ttname"><a href="classCAtomicSync.html#a800f80de01458303ff3ef71b591196b0">CAtomicSync::swap</a></div><div class="ttdeci">value_type swap(value_type c) volatile</div><div class="ttdoc">Get value and then set atomically. </div><div class="ttdef"><b>Definition:</b> atomic_sync.hh:275</div></div>
<div class="ttc" id="classCAtomicSync_html_a42b8d0a4687e6f050283f9525e4574d2"><div class="ttname"><a href="classCAtomicSync.html#a42b8d0a4687e6f050283f9525e4574d2">CAtomicSync::CAtomicSync</a></div><div class="ttdeci">CAtomicSync(const __Myt &amp;c)</div><div class="ttdoc">Initialize from another CAtomicSync. </div><div class="ttdef"><b>Definition:</b> atomic_sync.hh:56</div></div>
<div class="ttc" id="classCAtomicSync_html_ae40428b0e27d8e4eb578d2965a57b9f4"><div class="ttname"><a href="classCAtomicSync.html#ae40428b0e27d8e4eb578d2965a57b9f4">CAtomicSync::or_fetch</a></div><div class="ttdeci">value_type or_fetch(value_type c) volatile</div><div class="ttdoc">OR and then get value atomically. </div><div class="ttdef"><b>Definition:</b> atomic_sync.hh:185</div></div>
<div class="ttc" id="classCAtomicSync_html_aeef658711f60d07c644c091f98bc5256"><div class="ttname"><a href="classCAtomicSync.html#aeef658711f60d07c644c091f98bc5256">CAtomicSync::load</a></div><div class="ttdeci">value_type load() const volatile</div><div class="ttdoc">Get value atomically. </div><div class="ttdef"><b>Definition:</b> atomic_sync.hh:61</div></div>
<div class="ttc" id="classCAtomicSync_html_a1b4a85bf23aef90ec19d33062ded3a79"><div class="ttname"><a href="classCAtomicSync.html#a1b4a85bf23aef90ec19d33062ded3a79">CAtomicSync::CAtomicSync</a></div><div class="ttdeci">CAtomicSync(value_type c=value_type())</div><div class="ttdoc">Initialize with a value. </div><div class="ttdef"><b>Definition:</b> atomic_sync.hh:51</div></div>
<div class="ttc" id="classCAtomicSync_html_a08761322b28867ce843905271286e055"><div class="ttname"><a href="classCAtomicSync.html#a08761322b28867ce843905271286e055">CAtomicSync::xor_fetch</a></div><div class="ttdeci">static value_type xor_fetch(value_type *v, value_type c)</div><div class="ttdoc">XOR and then get value atomically. </div><div class="ttdef"><b>Definition:</b> atomic_sync.hh:265</div></div>
<div class="ttc" id="classCAtomicSync_html_ad5d9a892fe66a56cfcf70992e5fcceb7"><div class="ttname"><a href="classCAtomicSync.html#ad5d9a892fe66a56cfcf70992e5fcceb7">CAtomicSync::fetch_sub</a></div><div class="ttdeci">static value_type fetch_sub(value_type *v, value_type c)</div><div class="ttdoc">Get value and then SUBTRACT atomically. </div><div class="ttdef"><b>Definition:</b> atomic_sync.hh:139</div></div>
<div class="ttc" id="classCAtomicSync_html_a20116c1a0e05a4e0ee0b5e40160dcc62"><div class="ttname"><a href="classCAtomicSync.html#a20116c1a0e05a4e0ee0b5e40160dcc62">CAtomicSync::fetch_sub</a></div><div class="ttdeci">value_type fetch_sub(value_type c) volatile</div><div class="ttdoc">Get value and then SUBTRACT atomically. </div><div class="ttdef"><b>Definition:</b> atomic_sync.hh:131</div></div>
<div class="ttc" id="classCAtomicSync_html_a9c39c19f2ee1372d4501923015d4d0bb"><div class="ttname"><a href="classCAtomicSync.html#a9c39c19f2ee1372d4501923015d4d0bb">CAtomicSync::xor_fetch</a></div><div class="ttdeci">value_type xor_fetch(value_type c) volatile</div><div class="ttdoc">XOR and then get value atomically. </div><div class="ttdef"><b>Definition:</b> atomic_sync.hh:257</div></div>
<div class="ttc" id="classCAtomicSync_html_a9fbccf0e1f4d357c7c4416c67e2c3d0c"><div class="ttname"><a href="classCAtomicSync.html#a9fbccf0e1f4d357c7c4416c67e2c3d0c">CAtomicSync::fetch_xor</a></div><div class="ttdeci">value_type fetch_xor(value_type c) volatile</div><div class="ttdoc">Get value and then XOR atomically. </div><div class="ttdef"><b>Definition:</b> atomic_sync.hh:239</div></div>
<div class="ttc" id="classCAtomicSync_html_a7f3941a9b14a001f9aeea324d1af0086"><div class="ttname"><a href="classCAtomicSync.html#a7f3941a9b14a001f9aeea324d1af0086">CAtomicSync::fetch_or</a></div><div class="ttdeci">value_type fetch_or(value_type c) volatile</div><div class="ttdoc">Get value and then OR atomically. </div><div class="ttdef"><b>Definition:</b> atomic_sync.hh:167</div></div>
<div class="ttc" id="classCAtomicSync_html_aca73519f947756aa7eb520b5eeb507de"><div class="ttname"><a href="classCAtomicSync.html#aca73519f947756aa7eb520b5eeb507de">CAtomicSync::fetch_or</a></div><div class="ttdeci">static value_type fetch_or(value_type *v, value_type c)</div><div class="ttdoc">Get value and then OR atomically. </div><div class="ttdef"><b>Definition:</b> atomic_sync.hh:175</div></div>
<div class="ttc" id="classCAtomicSync_html_adbd228493fae2b1be866b22f20ee51e7"><div class="ttname"><a href="classCAtomicSync.html#adbd228493fae2b1be866b22f20ee51e7">CAtomicSync::and_fetch</a></div><div class="ttdeci">static value_type and_fetch(value_type *v, value_type c)</div><div class="ttdoc">AND and then get value atomically. </div><div class="ttdef"><b>Definition:</b> atomic_sync.hh:229</div></div>
<div class="ttc" id="classCAtomicSync_html_ab7fae7088e23cb9e3f21939dc4ab97d2"><div class="ttname"><a href="classCAtomicSync.html#ab7fae7088e23cb9e3f21939dc4ab97d2">CAtomicSync::store</a></div><div class="ttdeci">void store(value_type c) volatile</div><div class="ttdoc">Set value atomically. </div><div class="ttdef"><b>Definition:</b> atomic_sync.hh:78</div></div>
<div class="ttc" id="classCAtomicSync_html_a2d638d58ad439b3f6d923cf97a63af01"><div class="ttname"><a href="classCAtomicSync.html#a2d638d58ad439b3f6d923cf97a63af01">CAtomicSync::store</a></div><div class="ttdeci">static void store(value_type *v, value_type c)</div><div class="ttdoc">Set value atomically. </div><div class="ttdef"><b>Definition:</b> atomic_sync.hh:85</div></div>
<div class="ttc" id="classCAtomicSync_html_ae2c1736027f13002c5e83319e7c9afc7"><div class="ttname"><a href="classCAtomicSync.html#ae2c1736027f13002c5e83319e7c9afc7">CAtomicSync::sub_fetch</a></div><div class="ttdeci">static value_type sub_fetch(value_type *v, value_type c)</div><div class="ttdoc">SUBTRACT and then get value atomically. </div><div class="ttdef"><b>Definition:</b> atomic_sync.hh:157</div></div>
<div class="ttc" id="classCAtomicSync_html_a46c37f6df90d020ba65ee368934eb620"><div class="ttname"><a href="classCAtomicSync.html#a46c37f6df90d020ba65ee368934eb620">CAtomicSync::compare_swap</a></div><div class="ttdeci">bool compare_swap(value_type expval, value_type newval, value_type *oldval=NULL) volatile</div><div class="ttdoc">Compare and set atomically. </div><div class="ttdef"><b>Definition:</b> atomic_sync.hh:304</div></div>
<div class="ttc" id="classCAtomicSync_html"><div class="ttname"><a href="classCAtomicSync.html">CAtomicSync</a></div><div class="ttdoc">GCC __sync_XXX based atomic operations for integral types. </div><div class="ttdef"><b>Definition:</b> atomic_sync.hh:41</div></div>
<div class="ttc" id="classCAtomicSync_html_a7e7059f8f85ca634a98dd9ea90848558"><div class="ttname"><a href="classCAtomicSync.html#a7e7059f8f85ca634a98dd9ea90848558">CAtomicSync::fetch_add</a></div><div class="ttdeci">static value_type fetch_add(value_type *v, value_type c)</div><div class="ttdoc">Get value and then ADD atomically. </div><div class="ttdef"><b>Definition:</b> atomic_sync.hh:103</div></div>
<div class="ttc" id="classCAtomicSync_html_a598ddf1d30aeb3dd29ebb0be8e0309e0"><div class="ttname"><a href="classCAtomicSync.html#a598ddf1d30aeb3dd29ebb0be8e0309e0">CAtomicSync::fetch_and</a></div><div class="ttdeci">value_type fetch_and(value_type c) volatile</div><div class="ttdoc">Get value and then AND atomically. </div><div class="ttdef"><b>Definition:</b> atomic_sync.hh:203</div></div>
<div class="ttc" id="classCAtomicSync_html_ab228a9a9c4519f73875ba88385096a67"><div class="ttname"><a href="classCAtomicSync.html#ab228a9a9c4519f73875ba88385096a67">CAtomicSync::add_fetch</a></div><div class="ttdeci">value_type add_fetch(value_type c) volatile</div><div class="ttdoc">ADD and then get value atomically. </div><div class="ttdef"><b>Definition:</b> atomic_sync.hh:113</div></div>
<div class="ttc" id="classCAtomicSync_html_aef897c7ad9343a5f412673bc93a36522"><div class="ttname"><a href="classCAtomicSync.html#aef897c7ad9343a5f412673bc93a36522">CAtomicSync::fetch_add</a></div><div class="ttdeci">value_type fetch_add(value_type c) volatile</div><div class="ttdoc">Get value and then ADD atomically. </div><div class="ttdef"><b>Definition:</b> atomic_sync.hh:95</div></div>
<div class="ttc" id="classCAtomicSync_html_a2dd86acbf51e437a3f1158c5bdc06865"><div class="ttname"><a href="classCAtomicSync.html#a2dd86acbf51e437a3f1158c5bdc06865">CAtomicSync::sub_fetch</a></div><div class="ttdeci">value_type sub_fetch(value_type c) volatile</div><div class="ttdoc">SUBTRACT and then get value atomically. </div><div class="ttdef"><b>Definition:</b> atomic_sync.hh:149</div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
